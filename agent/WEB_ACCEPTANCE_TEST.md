# 🌐 Web ブラウザ受け入れテスト手順書

## 🎯 テスト目的
Web フロントエンドから銀行取引最適化ワークフローの全機能が正常に動作することをブラウザで確認する。

## 📋 事前準備

### 必要なソフトウェア
- Python 3.11+ (インストール済み)
- モダンブラウザ (Chrome, Firefox, Safari, Edge)
- インターネット接続 (Bootstrap CDN用)

### テスト環境セットアップ
```bash
# 1. 依存パッケージ確認
pip install flask werkzeug pandas numpy pulp matplotlib

# 2. Webサーバー起動
cd web/
python3 app.py

# Expected output:
# * Serving Flask app 'app'
# * Debug mode: on
# * Running on http://0.0.0.0:5001
```

### ブラウザアクセス確認
```
URL: http://localhost:5001
```

---

## 🧪 受け入れテストケース

### テスト1: ダッシュボード表示
**目的**: メインページの表示確認

**手順**:
1. ブラウザで `http://localhost:5001` にアクセス
2. ページが正常に表示されることを確認

**期待結果**:
- ✅ ナビゲーションバーが表示
- ✅ 「銀行取引最適化」タイトル表示
- ✅ 4つの統計カード表示 (3銀行、6支店、30日間、95%)
- ✅ ワークフローの4ステップが表示
- ✅ システム情報・クイックスタートエリア表示
- ✅ 現在時刻がリアルタイム更新
- ✅ レスポンシブデザイン (ブラウザサイズ変更テスト)

**スクリーンショット確認点**:
- モダンなBootstrapデザイン
- カラフルなアイコン・カード
- 日本語表示

---

### テスト2: ファイルアップロード機能
**目的**: CSV ファイルアップロード機能の確認

**手順**:
1. ナビゲーションから「ファイルアップロード」をクリック
2. アップロード手順説明を確認
3. **方法A: サンプルデータ使用**
   - 「サンプルデータ使用」ボタンをクリック
   - 確認ダイアログで「OK」
4. **方法B: 手動アップロード**
   - 4つのファイル選択エリアに各CSVをアップロード
   - `data/bank_master.csv`
   - `data/fee_table.csv`  
   - `data/balance_snapshot.csv`
   - `data/cashflow_history.csv`

**期待結果**:
- ✅ ファイル選択エリアが4つ表示
- ✅ ドラッグ&ドロップ対応
- ✅ ファイル検証機能 (CSV以外はエラー)
- ✅ サイズ制限 (16MB) 確認
- ✅ ファイルプレビュー表示
- ✅ サンプルデータ設定で最適化ページへ自動遷移
- ✅ 成功メッセージ表示

**エラーテスト**:
- 非CSVファイル選択 → エラー表示
- 16MB超ファイル → エラー表示

---

### テスト3: 最適化実行機能
**目的**: パラメータ設定と最適化実行の確認

**手順**:
1. ナビゲーションから「最適化実行」をクリック
2. パラメータ設定を確認・調整:
   - **ホライズン期間**: スライダーを30日に設定
   - **分位点**: 0.95に設定  
   - **ペナルティ重み**: 1.0に設定
   - **Cut-off時刻制約**: ONに設定
3. 「最適化開始」ボタンをクリック
4. 実行進捗を確認
5. 結果表示を確認

**期待結果**:
- ✅ 4つのパラメータスライダーが動作
- ✅ 値がリアルタイム更新表示
- ✅ 「最適化開始」ボタンが機能
- ✅ 実行中スピナー・進捗表示
- ✅ 実行時間 < 30秒
- ✅ 結果サマリー表示:
  - 資金移動件数
  - 総手数料
  - 実行時間
  - 対象銀行数
- ✅ 資金移動計画プレビュー (上位10件)
- ✅ ダウンロードリンク表示

**パフォーマンステスト**:
- 実行時間が30秒以内
- エラーなく完了

---

### テスト4: 結果表示・分析機能
**目的**: 詳細結果表示と分析機能の確認

**手順**:
1. ナビゲーションから「結果表示」をクリック
2. 「最新結果読込」ボタンをクリック
3. 結果データ表示を確認
4. 検索・フィルタ機能をテスト:
   - 検索ボックスに「MIZUHO」入力
   - 銀行フィルターで「MUFG」選択
   - サービスフィルターで「G」選択
5. グラフ表示を確認
6. ページネーション操作

**期待結果**:
- ✅ 4つのサマリーカード表示 (移動件数、手数料、実行時間、銀行数)
- ✅ 資金移動計画テーブル表示
- ✅ 検索機能動作
- ✅ 銀行・サービスフィルター動作
- ✅ ページネーション (20件/ページ)
- ✅ コスト比較棒グラフ表示
- ✅ 銀行別分布円グラフ表示
- ✅ 安全在庫分析カード表示
- ✅ 実行詳細情報表示
- ✅ CSV・Excel エクスポートボタン

**インタラクションテスト**:
- テーブルソート機能
- リアルタイム検索
- グラフホバー効果

---

### テスト5: KPI ダッシュボード機能
**目的**: KPI 監視・分析機能の確認

**手順**:
1. ナビゲーションから「KPI」をクリック
2. 表示期間選択をテスト:
   - 7日ボタンをクリック
   - 30日ボタンをクリック
   - 90日ボタンをクリック
3. KPI サマリーを確認
4. グラフ表示を確認
5. 「更新」ボタンをクリック
6. 実行履歴テーブルを確認

**期待結果**:
- ✅ 期間選択ボタン (7/30/90日) 動作
- ✅ KPI サマリーカード表示:
  - 総実行回数
  - 平均実行時間
  - 平均手数料
  - 残高不足総額
- ✅ 実行時間推移グラフ (折れ線)
- ✅ 手数料推移グラフ (棒グラフ)
- ✅ 総合KPI推移グラフ (複合)
- ✅ 異常検知エリア表示
- ✅ 実行履歴テーブル表示
- ✅ パフォーマンス・品質指標表示

**データ表示テスト**:
- モックデータが適切に表示
- グラフが正常にレンダリング
- 異常検知アラート機能

---

### テスト6: ファイルダウンロード機能
**目的**: 結果ファイルダウンロードの確認

**手順**:
1. 最適化実行後の結果画面で「CSVファイル」リンクをクリック
2. 「コスト比較図」リンクをクリック
3. ダウンロードされたファイルを確認

**期待結果**:
- ✅ CSV ファイルダウンロード成功
- ✅ PNG チャートファイルダウンロード成功
- ✅ ファイル内容が正常 (テキストエディタで確認)
- ✅ ファイル名に日時スタンプ含有

**ファイル内容確認**:
```csv
execute_date,from_bank,to_bank,service_id,amount,expected_fee
2025-06-08,MIZUHO,MUFG,G,100000,330
```

---

### テスト7: エラーハンドリング・UX
**目的**: エラー処理とユーザビリティの確認

**手順**:
1. **ファイルなしで最適化実行**:
   - ファイルアップロードせずに最適化ページにアクセス
   - 「最適化開始」をクリック
2. **不正ファイルアップロード**:
   - .txt ファイルをアップロード
   - 16MB超のファイルをアップロード
3. **ネットワークエラーシミュレーション**:
   - Webサーバーを停止
   - ページアクセスを試行

**期待結果**:
- ✅ 適切なエラーメッセージ表示
- ✅ ユーザーフレンドリーなエラー説明
- ✅ エラー後の復旧手順案内
- ✅ システムクラッシュなし

**UXテスト**:
- 読み込み中スピナー表示
- ボタン無効化処理
- 成功/エラー通知

---

### テスト8: レスポンシブ・クロスブラウザ
**目的**: 様々な環境での動作確認

**手順**:
1. **レスポンシブテスト**:
   - ブラウザ幅を1920px → 768px → 375px に変更
   - スマートフォン表示シミュレーション
2. **クロスブラウザテスト**:
   - Chrome で全機能テスト
   - Firefox で基本機能テスト
   - Safari で表示確認 (Mac)
   - Edge で表示確認 (Windows)

**期待結果**:
- ✅ モバイル表示で要素が適切にスタック
- ✅ タッチ操作対応
- ✅ 全ブラウザで基本機能動作
- ✅ フォント・アイコンが正常表示

---

### テスト9: パフォーマンス・セキュリティ
**目的**: システム性能とセキュリティの確認

**手順**:
1. **パフォーマンステスト**:
   - ページ読み込み時間測定
   - 最適化実行時間測定
   - メモリ使用量確認
2. **セキュリティテスト**:
   - 悪意あるファイルアップロード試行
   - SQLインジェクション試行
   - XSS攻撃試行

**期待結果**:
- ✅ ページ読み込み < 3秒
- ✅ 最適化実行 < 30秒
- ✅ メモリ使用量 < 1GB
- ✅ 悪意あるファイル拒否
- ✅ セキュリティ攻撃を適切にブロック

---

## 📊 受け入れ判定基準

### 必須項目 (MUST)
- [ ] 全5ページが正常表示
- [ ] ファイルアップロード→最適化→結果表示の全フロー成功
- [ ] エラーハンドリングが適切
- [ ] レスポンシブデザイン対応
- [ ] 実行時間 < 30秒

### 推奨項目 (SHOULD)
- [ ] 3ブラウザ以上で動作
- [ ] モバイル端末で操作可能
- [ ] 直感的なUI/UX
- [ ] グラフ・チャートが美しく表示

### オプション項目 (MAY)
- [ ] アニメーション効果
- [ ] 高度な検索・フィルタ
- [ ] エクスポート機能
- [ ] リアルタイム更新

---

## 🚨 トラブルシューティング

### よくある問題と対処法

**ページが表示されない**
```bash
# Webサーバーの状態確認
ps aux | grep python
# ポート使用状況確認
lsof -i :5001
# 再起動
cd web/ && python3 app.py
```

**ファイルアップロードエラー**
- ファイルサイズ < 16MB を確認
- CSV形式を確認
- `web/uploads/` ディレクトリの権限確認

**最適化が実行されない**
- サンプルデータが正しく設定されているか確認
- ブラウザコンソールでJavaScriptエラー確認
- Flask サーバーログでPythonエラー確認

**グラフが表示されない**
- インターネット接続確認 (Chart.js CDN)
- ブラウザでJavaScript有効化確認
- キャッシュクリア

---

## ✅ 受け入れテストチェックリスト

### 基本機能
- [ ] ダッシュボード表示
- [ ] ファイルアップロード機能
- [ ] 最適化実行機能
- [ ] 結果表示機能
- [ ] KPI ダッシュボード機能

### UI/UX
- [ ] ナビゲーション動作
- [ ] レスポンシブデザイン
- [ ] エラーメッセージ表示
- [ ] 読み込み中表示
- [ ] 成功通知表示

### データ処理
- [ ] CSV ファイル読み込み
- [ ] 最適化計算実行
- [ ] 結果データ表示
- [ ] グラフレンダリング
- [ ] ファイルダウンロード

### パフォーマンス
- [ ] ページ読み込み速度
- [ ] 最適化実行時間
- [ ] メモリ使用量
- [ ] ネットワーク効率

### セキュリティ
- [ ] ファイル検証
- [ ] 入力値検証
- [ ] エラーハンドリング
- [ ] セッション管理

---

## 📋 テスト報告書テンプレート

```
## Web ブラウザ受け入れテスト報告書

**テスト実施日**: _______________
**テスト実施者**: _______________
**テスト環境**: 
- OS: _______________
- ブラウザ: _______________
- Python: _______________

### テスト結果サマリー
- 実行テストケース: _____ / 9
- 成功: _____ 
- 失敗: _____
- 実行時間: _____ 分

### 合否判定
- [ ] 合格 - 全機能が要求水準を満たす
- [ ] 条件付き合格 - 軽微な問題あり
- [ ] 不合格 - 重要な機能に問題あり

### コメント
________________________________
________________________________

**署名**: _______________
```

---

**🎯 この手順書に従って受け入れテストを実施し、Web フロントエンドの品質を確認してください。**

© 2025 Mizuho Digital Planning Team